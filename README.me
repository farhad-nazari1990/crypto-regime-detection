Crypto Regime Detection using Machine Learning
Hidden Markov Models Â· Gaussian Mixture Models Â· Bayesian Change Point Detection
Financial Machine Learning Project â€“ Bitcoin Market Regime Identification
ğŸ“Œ Overview

Crypto markets constantly shift between structural regimes such as panic crashes, high-volatility turbulence, strong momentum trends, and stable mean-reversion phases.
This project implements a complete end-to-end Regime Detection Pipeline for Bitcoin (BTC), combining statistical modeling with modern ML tools:

Primary Model â€” Hidden Markov Model (HMM)

Baseline Model â€” Gaussian Mixture Model (GMM)

Scientific Add-on â€” Bayesian Change Point Detection (CPD)

The goal is to classify BTCâ€™s historical price data into interpretable market regimes, visualize them, and analyze their performance characteristics.

ğŸ¯ Key Deliverables

âœ” Color-coded BTC price chart with regime overlays
âœ” Regime performance table (returns, volatility, Sharpe, drawdown)
âœ” HMM transition matrix
âœ” GMM cluster centroids & feature profiles
âœ” Bayesian CPD change-point markers
âœ” Fully reproducible, modular, and extendable codebase

ğŸ“Š Defined Market Regimes (4-State Model)
Regime	Description
Panic Regime	Extreme negative returns, volatility spikes, disorderly price moves
High-Volatility Regime	Unstable periods with large swings and noisy signals
Momentum Trend Regime	Positive autocorrelation, strong directional trends
Low-Vol Mean-Reversion Regime	Stable conditions, low volatility, oscillatory behavior
ğŸ— Project Structure
crypto-regime-detection/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/                    # Raw OHLCV data
â”‚   â””â”€â”€ processed/              # Cleaned data + engineered features
â”œâ”€â”€ notebooks/
â”‚   â”œâ”€â”€ 01_EDA.ipynb
â”‚   â”œâ”€â”€ 02_HMM_Modeling.ipynb
â”‚   â”œâ”€â”€ 03_GMM_Comparison.ipynb
â”‚   â”œâ”€â”€ 04_CPD_Analysis.ipynb
â”‚   â””â”€â”€ 05_Presentation.ipynb
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â””â”€â”€ load_and_clean.py
â”‚   â”œâ”€â”€ features/
â”‚   â”‚   â”œâ”€â”€ build_features.py
â”‚   â”‚   â””â”€â”€ select_features.py
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ hmm_model.py
â”‚   â”‚   â”œâ”€â”€ gmm_baseline.py
â”‚   â”‚   â””â”€â”€ change_point_detection.py
â”‚   â”œâ”€â”€ evaluation/
â”‚   â”‚   â”œâ”€â”€ performance_by_regime.py
â”‚   â”‚   â””â”€â”€ describe_states.py
â”‚   â””â”€â”€ viz/
â”‚       â””â”€â”€ plot_regimes.py
â”œâ”€â”€ results/
â”‚   â”œâ”€â”€ plots/
â”‚   â”œâ”€â”€ tables/
â”‚   â””â”€â”€ models/
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md

ğŸ”§ Installation
git clone https://github.com/<your-username>/crypto-regime-detection.git
cd crypto-regime-detection
pip install -r requirements.txt

ğŸ“¥ Data

You may use:

Binance API

CoinGecko API

Kaggle OHLCV datasets

Yahoo Finance (yfinance)

Expected fields:

timestamp, open, high, low, close, volume


Place raw BTC data in:

data/raw/btc.csv

ğŸ§© Feature Engineering

The pipeline generates a curated set of features that capture market structure, including:

Log returns

Rolling volatility (Ïƒâ‚â‚€, Ïƒâ‚‚â‚€)

Z-scored returns

Volume/MA ratios

Momentum signals

Realized volatility

(Optional) RSI, MACD, skewness, kurtosis

Run:

python src/features/build_features.py


Output:

data/processed/features.csv

ğŸ”® Model 1 â€” Hidden Markov Model (HMM)

Used as the primary regime classifier.

Why HMM?

Learns hidden state dynamics

Captures transitions between regimes

Smoother and more interpretable allocation vs. clustering models

Model specification: GaussianHMM(n_components=4)

Run:

python src/models/hmm_model.py


Outputs:

hmm_regime_labels.csv

Transition matrix

State-level feature summaries

ğŸ› Model 2 â€” Gaussian Mixture Model (GMM)

Used as a baseline for comparison and validation.

Advantages:

Fast, simple, probabilistic

Provides contrast against HMMâ€™s temporal structure

Helps validate separability of engineered features

Run:

python src/models/gmm_baseline.py


Outputs:

gmm_labels.csv

Cluster plots

BIC/AIC benchmark scores

ğŸ”¬ Add-On â€” Bayesian Change Point Detection (CPD)

Enhances scientific rigor by identifying structural breaks in volatility/returns.
Often aligns closely with HMM regime transitions.

Run:

python src/models/change_point_detection.py


Outputs:

cpd_points.csv

Price chart with CPD overlay

ğŸ“ˆ Regime Visualization

Generates the projectâ€™s core visualization: BTC price colored by regime.

Run:

python src/viz/plot_regimes.py


Saved to:

results/plots/btc_regimes_colored.png

ğŸ“Š Regime Performance Analysis

Evaluates each regimeâ€™s statistical properties:

Mean return

Volatility

Sharpe ratio

Max drawdown

Cumulative return

Duration (days in regime)

Run:

python src/evaluation/performance_by_regime.py


Outputs:

results/tables/performance_per_regime.csv

ğŸ§ª Validation & Comparison

Includes:

HMM vs. GMM alignment

Confusion matrix

Feature drift analysis

Sensitivity tests (components, window sizes)

Notebook: 03_model_comparison.ipynb

ğŸ“¢ Example Insights

Panic Regimes exhibit extreme negative returns and volatility clustering.

Momentum Regimes show strong trend continuation and directional persistence.

Low-Volatility Regimes provide stable environments for mean-reversion strategies.

CPD markers strongly overlap with HMM state transitions, confirming structural shifts.

ğŸ“¬ Contact

For collaborations on:

Market regime detection

ML-based crypto risk models

Algorithmic trading infrastructure

Quantitative research

Feel free to reach out.

LinkedIn: https://www.linkedin.com/in/

<your-name>
Email: your.email@example.com
ğŸ“„ License

MIT License â€” free to use, modify, and build upon.
