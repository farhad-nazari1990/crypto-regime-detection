# ğŸ“ˆ Crypto Market Regime Detection


> A research-grade, modular framework for **detecting market regimes** in Crypto (and FX) using Machine Learning, Hidden Markov Models, clustering, technical signals, and walk-forward evaluation.

Designed for **Financial Data Scientists** and **Quantitative Researchers**.

---

## ğŸ“‘ Table of Contents
- [Key Capabilities](#-key-capabilities)
- [System Architecture](#-system-architecture)
- [Project Structure](#-project-structure)
- [Installation](#-installation)
- [Quick Start](#-quick-start)
- [Configuration](#-configuration-yaml-based)
- [Evaluation & Research](#-evaluation)
- [Roadmap](#-roadmap)
- [Contact](#-contact)

---

## ğŸ“Œ Key Capabilities

| ğŸ” **Market Regime Detection** | âš™ï¸ **Feature Engineering** |
| :--- | :--- |
| â€¢ **HMM-based** state discovery<br>â€¢ **Clustering:** KMeans, GMM, Bayesian<br>â€¢ **Supervised ML:** XGBoost, RF Classifiers | â€¢ Volatility, Returns, Rolling Stats<br>â€¢ **Trend:** RSI, MACD, ADX, CCI<br>â€¢ Microstructure & Liquidity features<br>â€¢ Recession & Momentum meta-features |

| ğŸ§ª **Evaluation** | ğŸ“Š **Visualization Tools** |
| :--- | :--- |
| â€¢ **Walk-forward** backtesting<br>â€¢ Rolling model training<br>â€¢ Confusion matrices & ROC/PR plots<br>â€¢ Predictive performance curves | â€¢ Regime Timelines<br>â€¢ State Distribution Charts<br>â€¢ Performance Comparison<br>â€¢ Transition Heatmaps |

---

## ğŸ§¬ System Architecture

The pipeline follows a modular design ensuring separation of concerns between data loading, feature extraction, and model inference.

```mermaid
graph TD;
    A[Data Loader<br/>Crypto/FX - Yahoo, APIs] --> B[Feature Engineering<br/>TI, Stats, Volatility];
    B --> C[Regime Detection ML<br/>HMM | KMeans | GMM | XGBoost];
    C --> D[Walk-Forward Evaluation];
    D --> E[Reports & Plots];
<!-- Fallback ASCII if Mermaid is not rendered -->

<details>
<summary>Click to view ASCII Architecture</summary>

code
Text
download
content_copy
expand_less
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚          Data Loader          â”‚
            â”‚  (Crypto/FX â€“ Yahoo, APIs)    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ Feature Engineering â”‚
                 â”‚  (TI, stats, vol)   â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚     Regime Detection ML      â”‚
              â”‚ HMM | KMeans | GMM | XGBoost â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   Walk-Forward Evaluation     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚   Reports & Plots     â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</details>

ğŸ“ Project Structure
code
Bash
download
content_copy
expand_less
crypto-regime-detection/
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ data/            # Data loaders, preprocessors, cleaning
â”‚   â”œâ”€â”€ features/        # Feature engineering pipelines
â”‚   â”œâ”€â”€ models/          # ML models & regime detection algorithms
â”‚   â”œâ”€â”€ visualization/   # Charts and reporting
â”‚   â”œâ”€â”€ evaluation/      # Walk-forward & metrics
â”‚   â””â”€â”€ utils/           # Config, logging, utilities
â”‚
â”œâ”€â”€ notebooks/           # Research & prototyping notebooks
â”œâ”€â”€ configs/             # YAML configs for reproducible experiments
â”œâ”€â”€ requirements.txt     # Python dependencies
â””â”€â”€ README.md            # Project documentation
ğŸš€ Installation
1. Clone the repository
code
Bash
download
content_copy
expand_less
git clone https://github.com/farhad-nazari1990/crypto-regime-detection.git
cd crypto-regime-detection
2. Install dependencies

It is recommended to use a virtual environment.

code
Bash
download
content_copy
expand_less
pip install -r requirements.txt
âš¡ Quick Start
Run the full pipeline

Execute the main script using a configuration file:

code
Bash
download
content_copy
expand_less
python src/main.py --config configs/btc_historical.yaml
Run Research Notebooks

Explore the data and models interactively:

code
Bash
download
content_copy
expand_less
jupyter notebook notebooks/
ğŸ§© Configuration (YAML-Based)

Experiments are controlled via YAML files in the configs/ directory.

Example: configs/btc_historical.yaml

code
Yaml
download
content_copy
expand_less
symbol: "BTC-USD"
date_range:
  start: "2018-01-01"
  end: "2024-01-01"

features:
  - returns
  - volatility
  - rsi
  - macd
  - microstructure

model:
  type: "hmm"  # Options: hmm, kmeans, gmm, xgboost
  n_states: 3

evaluation:
  mode: "walk_forward"
  window: 250
ğŸ§ª Evaluation
Running Walk-Forward Evaluation

Validate model robustness by training on a rolling window and testing on unseen data.

code
Bash
download
content_copy
expand_less
python src/evaluation/run_walkforward.py \
  --config configs/btc_historical.yaml

Key Outputs:

âœ… Regime Timeline: Historical segmentation of market states.

âœ… Transition Matrix: Probability of switching between regimes.

âœ… Performance Metrics: Sharpe ratio per regime, predictive accuracy.

âœ… Confusion Matrix: Stability of classification.

ğŸ“Š Visualizations

Use the visualization module to generate publication-ready plots.

code
Python
download
content_copy
expand_less
from src.visualization.regime_plot import plot_regimes

# Plot regimes overlaid on price action
plot_regimes(df, states)

Generates: Regime distribution pie charts, state transition heatmaps, and feature importance charts.

ğŸ“˜ Research Background

The project is inspired by quantitative finance literature:

Regime-switching models in financial markets.

Hidden Markov Models (HMM) for unsupervised state discovery.

Volatility clustering & structural break dynamics.

Walk-forward validation frameworks (Ref: Lopez de Prado, Advances in Financial Machine Learning).

ğŸ”® Roadmap

Add Transformer-based time-series models (TFT, TCN).

Integrate Funding Rates + Orderbook features.

Build documentation website (MkDocs Material).

Backtesting integration with vectorbt or bt.

Real-time inference API.

ğŸ¤ Contributing

Contributions are welcome! Please follow these steps:

Fork the project.

Create your feature branch (git checkout -b feature/AmazingFeature).

Commit your changes (git commit -m 'Add some AmazingFeature').

Push to the branch (git push origin feature/AmazingFeature).

Open a Pull Request.

Please open an issue before submitting a major PR.

ğŸ“ License

Distributed under the MIT License. See LICENSE for more information.

ğŸ™‹ Contact

Farhad Nazari

