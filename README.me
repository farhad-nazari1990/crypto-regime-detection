# ğŸŒ€ Crypto Regime Detection using Machine Learning  
### Hidden Markov Models Â· Gaussian Mixture Models Â· Bayesian Change Point Detection  
### Financial Machine Learning Project â€“ Bitcoin Market Regime Identification

---

## ğŸ“Œ Project Overview

Financial markets â€” especially crypto â€” frequently shift between structural *regimes* such as high volatility, momentum trends, panic crashes, and low-volatility mean-reversion phases.  
This project builds a **full end-to-end Regime Detection Pipeline** for Bitcoin (BTC) using a mix of classical statistical models and modern ML techniques:

### **Primary Model â†’ Hidden Markov Model (HMM)**
### **Baseline Model â†’ Gaussian Mixture Model (GMM)**
### **Scientific Add-on â†’ Bayesian Change Point Detection (CPD)**

The objective is to **classify BTC price history into 3â€“4 interpretable regimes**, visualize them, and quantify the performance of each regime.

---

## ğŸ¯ Key Deliverables (Outputs)

âœ” **Colored BTC Price Chart (Regime Visualization)**  
âœ” **Regime performance table (Sharpe, mean return, vol, drawdown)**  
âœ” **Transition matrix (HMM)**  
âœ” **Cluster centroids & feature profiles (GMM)**  
âœ” **Change point detection overlay chart (Bayesian CPD)**  
âœ” **Full reproducible pipeline with modular code**

---

## ğŸ“Š Defined Market Regimes (4 States)

| Regime | Description |
|--------|-------------|
| **Panic Regime** | High volatility + large negative returns + volume spikes |
| **High Volatility Regime** | High vol, mixed returns, unstable transitions |
| **Momentum Trend Regime** | Positive serial correlation + trend continuation |
| **Low-Vol Mean Reversion Regime** | Stable periods, low vol, oscillatory behavior |

---

## ğŸ— Project Structure

```

crypto-regime-detection/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/                    # Raw BTC price data (OHLCV)
â”‚   â””â”€â”€ processed/              # Cleaned data + engineered features
â”œâ”€â”€ notebooks/
â”‚   â”œâ”€â”€ 01_EDA.ipynb
â”‚   â”œâ”€â”€ 02_HMM_Modeling.ipynb
â”‚   â”œâ”€â”€ 03_GMM_Comparison.ipynb
â”‚   â”œâ”€â”€ 04_CPD_Analysis.ipynb
â”‚   â””â”€â”€ 05_Presentation.ipynb   # Polished results for readers
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â””â”€â”€ load_and_clean.py
â”‚   â”œâ”€â”€ features/
â”‚   â”‚   â”œâ”€â”€ build_features.py
â”‚   â”‚   â””â”€â”€ select_features.py
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ hmm_model.py
â”‚   â”‚   â”œâ”€â”€ gmm_baseline.py
â”‚   â”‚   â””â”€â”€ change_point_detection.py
â”‚   â”œâ”€â”€ evaluation/
â”‚   â”‚   â”œâ”€â”€ performance_by_regime.py
â”‚   â”‚   â””â”€â”€ describe_states.py
â”‚   â””â”€â”€ viz/
â”‚       â””â”€â”€ plot_regimes.py
â”œâ”€â”€ results/
â”‚   â”œâ”€â”€ plots/
â”‚   â”œâ”€â”€ tables/
â”‚   â””â”€â”€ models/
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md

````

---

## ğŸ”§ Installation

```bash
git clone https://github.com/<your-username>/crypto-regime-detection.git
cd crypto-regime-detection
pip install -r requirements.txt
````

---

## ğŸ“¥ Data

You may use:

* Binance API (spot or futures)
* CoinGecko API
* Kaggle OHLCV datasets
* Yahoo Finance (`yfinance`)

Minimum required fields:

```
timestamp, open, high, low, close, volume
```

Place raw data inside:

```
data/raw/btc.csv
```

---

## ğŸ§© Feature Engineering

This project uses a carefully curated set of features known to capture market structure:

* **Log Returns**
* **Rolling Volatility (Ïƒ_10, Ïƒ_20)**
* **Z-scored Returns**
* **Volume/MA Ratio**
* **Momentum (n-period)**
* **Realized Volatility**
* Optional: RSI, MACD, skewness, kurtosis

Run:

```bash
python src/features/build_features.py
```

Output saved in:

```
data/processed/features.csv
```

---

## ğŸ”® Model 1 â€” Hidden Markov Model (HMM)

Used as the **primary regime classification model**.

### Why HMM?

* Captures hidden states
* Learns transition dynamics
* Fits well to financial time series
* Smooth regime allocation vs. clustering

Model: `GaussianHMM` with `n_components=4`.

Run:

```bash
python src/models/hmm_model.py
```

Outputs:

* `hmm_regime_labels.csv`
* Transition matrix
* State feature profiles

---

## ğŸ› Model 2 â€” Gaussian Mixture Model (GMM)

Used as a **baseline comparison**.

Why?

* Simple, fast, probabilistic
* Provides good contrast against HMM
* Helps validate feature separation

Run:

```bash
python src/models/gmm_baseline.py
```

Outputs:

* `gmm_labels.csv`
* Cluster plots
* BIC/AIC comparison

---

## ğŸ”¬ Add-on â€” Bayesian Change Point Detection (CPD)

Used to detect **structural change points** in volatility/returns.

Adds scientific depth and helps validate HMM transitions.

Run:

```bash
python src/models/change_point_detection.py
```

Outputs:

* `cpd_points.csv`
* overlay chart with HMM regimes

---

## ğŸ“ˆ Regime Visualization

Generates the core chart of the project:

> **BTC price series with color-coded regimes**

Run:

```bash
python src/viz/plot_regimes.py
```

Results stored in:

```
results/plots/btc_regimes_colored.png
```

---

## ğŸ“Š Regime Performance Analysis

Measures:

* Mean return
* Volatility
* Sharpe
* Max drawdown
* Cumulative return per regime
* Number of days per regime

Run:

```bash
python src/evaluation/performance_by_regime.py
```

Outputs saved in:

```
results/tables/performance_per_regime.csv
```

---

## ğŸ§ª Validation & Comparison

Includes:

* HMM vs GMM confusion matrix
* Regime alignment
* Feature drift
* Sensitivity tests: number of components, window sizes

Notebook:
`notebooks/03_model_comparison.ipynb`

---

## ğŸ“¢ Example Insights (to include in LinkedIn post)

* BTCâ€™s **Panic Regimes** show extreme negative returns and volatility clustering.
* **Momentum Regimes** exhibit strong trend continuation signals.
* **Low-Vol Regimes** provide stable environments suitable for mean-reversion strategies.
* CPD aligns strongly with HMM transitions, confirming structural breaks.

---

## ğŸ“¬ Contact

If you are interested in:

* Market regime detection
* ML-based crypto risk models
* Algorithmic trading infrastructure
* Quant research consulting

Feel free to reach out!

**LinkedIn:** [https://www.linkedin.com/in/](https://www.linkedin.com/in/)<your-name>
**Email:** [your.email@example.com](mailto:your.email@example.com)

---

## ğŸ“„ License

MIT License. Free to use, modify, and build upon.

